<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://java.sun.com/jsf/facelets" template="/templates/restaurant_model.xhtml">

    <ui:define name="titleRestaurant">
        <!-- <p:outputLabel value="#{restaurantBean.restaurantSelected.name}" /> -->
        <title>#{menuBean.menu.restaurant.name} -
            #{menuBean.menu.name}</title>
    </ui:define>

    <ui:define name="content-restaurant">
        <f:metadata>
            <f:viewParam name="restaurantCode" value="#{menuBean.menu.code}" />
            <f:event type="preRenderView" listener="#{categoryBean.list}" />
            <f:event type="preRenderView" listener="#{menuItemBean.list}" />
        </f:metadata>
        <div id="overview" class="bg-gray-900 h-screen">
            <h:form id="listItemsForm" class="pb-5">
                <div class="card">
                    <h1 class="text-2xl font-bold py-1">#{menuBean.menu.name}</h1>
                    <h2 class="text-lg font-medium py-1">#{menuBean.menu.description}</h2>




                    <p:tabView value="#{categoryBean.categories}" id="categoryTabView" dynamic="true" cache="true"
                        var="category">
                        <p:ajax event="tabChange" listener="#{menuItemBean.list}" />


                        <!-- Category Tabs -->
                        <p:tab title="#{category.name}" id="categoryTab" titletip="#{category.description}">


                            <p:panel header="#{menuBean.menu.name} - #{menuBean.menu.description}" styleClass="p-3">
                                <!-- Menu Item DataTable -->
                                <p:dataTable value="#{menuItemBean.items}" id="menuItemTreeTable" var="item"
                                    emptyMessage="No items found" lazy="true" rowKey="#{item.code}"
                                    rowStyleClass="#{item.category == category ? '' : 'ui-helper-hidden'}">

                                    <!-- Add Category button -->
                                    <f:facet name="header">
                                        <p:commandButton value="Add Category"
                                            oncomplete="PF('addCategoryDialog').show();"
                                            actionListener="#{categoryBean.add}" icon="fa fa-plus"
                                            update=":listItemsForm:categoryTabView">
                                            <f:actionListener
                                                type="org.omnifaces.eventlistener.ResetInputAjaxActionListener" />
                                        </p:commandButton>
                                    </f:facet>

                                    <p:column headerText="Name">
                                        <h:outputText value="#{item.name}" id="itemName" />
                                        <p:tooltip for="itemName" value="#{item.description} #{item.ingredients}"
                                            position="top" />
                                    </p:column>
                                    <p:column headerText="Price">
                                        <h:outputText value="#{item.price}">
                                            <f:convertNumber currencySymbol="$" type="currency" />
                                        </h:outputText>
                                    </p:column>
                                    <p:column headerText="Available">
                                        <h:outputText value="#{item.available == 'true' ? 'Yes' : 'No'}"
                                            styleClass="#{item.available == 'true' ? 'text-green-500' : 'text-red-500'}" />
                                    </p:column>
                                    <p:column headerText="Kitchen">
                                        <h:outputText value="#{item.kitchen == 'true' ? 'Yes' : 'No'}"
                                            styleClass="#{item.kitchen == 'true' ? 'text-green-500' : 'text-red-500'}" />
                                    </p:column>
                                    <!-- <p:column style="width:3rem">
                                    <p:commandButton update=":form:itemPanel" oncomplete="PF('itemDialog').show()"
                                        title="View Detail" icon="pi pi-search">
                                        <f:setPropertyActionListener value="#{item}" target="#{menuItemBean.item}" />
                                    </p:commandButton>
                                </p:column> -->

                                </p:dataTable>
                            </p:panel>

                            <!-- <p:dialog id="addCategoryDialog" header="Dish" showEffect="fade" widgetVar="itemDialog"
                                modal="true" resizable="false">
                                <p:outputPanel id="itemPanel">
                                    <h:panelGrid columns="2" cellpadding="7" rendered="#{not empty menuItemBean.item}">
                                        <h:outputLabel for="name" value="Name" styleClass="text-secondary" />
                                        <h:outputText id="name" value="#{menuItemBean.item.name}" />
                                        <h:outputLabel for="description" value="Description"
                                            styleClass="text-secondary" />
                                        <h:outputText id="description" value="#{menuItemBean.item.description}" />

                                        <h:outputLabel for="price" value="Price" styleClass="text-secondary" />
                                        <h:outputText id="size" value="#{menuItemBean.item.price}" />

                                        <h:outputLabel for="available" value="available" styleClass="text-secondary" />
                                        <h:outputText id="available" value="#{menuItemBean.item.available}" />
                                        <h:outputLabel for="kitchen" value="kitchen" styleClass="text-secondary" />
                                        <h:outputText id="kitchen" value="#{menuItemBean.item.kitchen}" />
                                    </h:panelGrid>
                                </p:outputPanel>
                            </p:dialog> -->

                        </p:tab>
                    </p:tabView>
                </div>
            </h:form>


            <!-- Add Category Modal -->
            <p:dialog header="Category - Add" widgetVar="addCategoryDialog" modal="true" resizable="false"
                draggable="false" showEffect="fade" hideEffect="fade" closable="false">
                <h:form id="addCategoryForm">
                    <h:panelGrid columns="1" id="addCategoryPanelGrid">
                        <p:outputLabel value="Name" />
                        <p:inputText id="nome" maxlength="50" size="30" value="#{categoryBean.category.name}"
                            required="true" requiredMessage="O campo Nome é obrigatório." />

                        <p:outputLabel value="Description" />
                        <p:inputText id="descricao" maxlength="50" size="30"
                            value="#{categoryBean.category.description}" />
                    </h:panelGrid>
                    <h:panelGrid columns="2">
                        <p:commandButton value="Save" actionListener="#{categoryBean.save}"
                            update=":dialogMessage :addCategoryForm:addCategoryPanelGrid :listItemsForm:categoryTabView">
                            <f:actionListener type="org.omnifaces.eventlistener.ResetInputAjaxActionListener" />
                        </p:commandButton>
                        <p:commandButton value=" Close" oncomplete="PF('addCategoryDialog').hide();" />
                    </h:panelGrid>
                </h:form>
            </p:dialog>
        </div>
    </ui:define>
</ui:composition>